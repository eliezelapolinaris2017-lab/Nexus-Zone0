<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadora de Carga Térmica</title>
  <style>
    :root {
      --bg: #050814;
      --card: #111827;
      --accent: #00d4ff;
      --accent-soft: rgba(0, 212, 255, 0.18);
      --text: #f9fafb;
      --muted: #9ca3af;
      --danger: #f97373;
      --border: rgba(148, 163, 184, 0.25);
      --radius: 14px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.8);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%, #000 100%);
      color: var(--text);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px 12px 40px;
    }

    .app-shell {
      width: 100%;
      max-width: 460px;
      background: radial-gradient(circle at top, #020617 0, #000 65%);
      border-radius: 30px;
      padding: 18px 14px 26px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow: 0 25px 60px rgba(0, 0, 0, 0.85);
      position: relative;
    }

    /* notch estilo iPhone */
    .notch {
      position: absolute;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 20px;
      background: #020617;
      border-radius: 20px;
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.9);
    }

    header {
      margin-top: 18px;
      margin-bottom: 14px;
      padding: 4px 4px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-circle {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #22d3ee, #0369a1 55%, #020617 100%);
      border: 1px solid rgba(191, 219, 254, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 16px;
      color: #e0f2fe;
      box-shadow: 0 10px 20px rgba(8, 47, 73, 0.9);
    }

    .brand-text h1 {
      font-size: 17px;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .brand-text p {
      font-size: 11px;
      color: var(--muted);
    }

    .badge-climate {
      font-size: 11px;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(96, 165, 250, 0.6);
      background: radial-gradient(circle at top left,
          rgba(56, 189, 248, 0.22),
          rgba(15, 23, 42, 0.92));
      color: #e0f2fe;
    }

    .card {
      background: radial-gradient(circle at top left,
          rgba(15, 118, 255, 0.16),
          rgba(15, 23, 42, 0.96));
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 14px 14px 12px;
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(20px);
    }

    .subtitle {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 8px;
    }

    .field label {
      font-size: 12px;
      color: #e5e7eb;
    }

    .field small {
      font-size: 11px;
      color: var(--muted);
    }

    .field input,
    .field select {
      margin-top: 2px;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.55);
      background: rgba(15, 23, 42, 0.9);
      padding: 7px 10px;
      font-size: 13px;
      color: var(--text);
      outline: none;
      transition: border 0.2s, box-shadow 0.2s, background 0.2s;
    }

    .field input::placeholder {
      color: rgba(148, 163, 184, 0.75);
    }

    .field input:focus,
    .field select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.55);
      background: rgba(15, 23, 42, 0.98);
    }

    .pill-row {
      display: flex;
      gap: 8px;
      margin: 10px 0 4px;
      flex-wrap: wrap;
    }

    .pill {
      font-size: 11px;
      padding: 5px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--muted);
      cursor: pointer;
      user-select: none;
      background: rgba(15, 23, 42, 0.6);
      transition: all 0.18s ease-out;
    }

    .pill.active {
      border-color: var(--accent);
      background: radial-gradient(circle at top,
          rgba(56, 189, 248, 0.45),
          rgba(15, 23, 42, 0.9));
      color: #ecfeff;
      box-shadow: 0 0 18px rgba(56, 189, 248, 0.55);
    }

    .btn-primary {
      margin-top: 10px;
      width: 100%;
      border: none;
      border-radius: 999px;
      padding: 10px 14px;
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 0.02em;
      background: radial-gradient(circle at top left,
          #22d3ee,
          #0ea5e9 45%,
          #0369a1 100%);
      color: #0b1120;
      box-shadow: 0 18px 35px rgba(8, 47, 73, 0.9);
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease,
        filter 0.18s ease;
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow: 0 10px 25px rgba(8, 47, 73, 0.85);
      filter: brightness(0.96);
    }

    .results {
      margin-top: 14px;
      padding: 10px 12px;
      border-radius: 12px;
      background: radial-gradient(circle at top left,
          rgba(8, 47, 73, 0.85),
          rgba(15, 23, 42, 0.97));
      border: 1px solid rgba(56, 189, 248, 0.4);
      box-shadow: 0 15px 40px rgba(8, 47, 73, 0.8);
    }

    .results-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
    }

    .results-title {
      font-size: 13px;
      font-weight: 600;
      color: #e0f2fe;
    }

    .results-badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(56, 189, 248, 0.6);
      color: #7dd3fc;
    }

    .btu-main {
      margin-top: 6px;
      display: flex;
      align-items: baseline;
      gap: 6px;
    }

    .btu-value {
      font-size: 22px;
      font-weight: 700;
    }

    .btu-unit {
      font-size: 12px;
      color: var(--muted);
    }

    .tons-line {
      margin-top: 3px;
      font-size: 12px;
      color: #e5e7eb;
    }

    .recommended {
      margin-top: 10px;
      padding-top: 8px;
      border-top: 1px dashed rgba(148, 163, 184, 0.6);
      font-size: 12px;
    }

    .recommended span {
      color: #e5e7eb;
      font-weight: 600;
    }

    .badges-row {
      margin-top: 6px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .mini-badge {
      font-size: 11px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--muted);
    }

    .error-msg {
      margin-top: 8px;
      font-size: 11px;
      color: var(--danger);
    }

    footer {
      margin-top: 12px;
      text-align: center;
      font-size: 10px;
      color: rgba(148, 163, 184, 0.7);
    }

    @media (max-width: 420px) {
      .app-shell {
        border-radius: 24px;
        padding-inline: 10px;
      }

      header {
        margin-top: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <div class="notch"></div>

    <header>
      <div class="brand">
        <div class="logo-circle">Ω</div>
        <div class="brand-text">
          <h1>Carga Térmica PRO</h1>
          <p>Estimador rápido para mini split</p>
        </div>
      </div>
      <div class="badge-climate">Clima: Caribe / PR</div>
    </header>

    <main class="card" aria-label="Calculadora de carga térmica">
      <p class="subtitle">
        Ingresa las dimensiones y condiciones del área. Calcularemos la carga
        térmica estimada en BTU/h y sugeriremos el tamaño de equipo.
      </p>

      <!-- Dimensiones -->
      <div class="grid-2">
        <div class="field">
          <label for="largo">Largo (m)</label>
          <input id="largo" type="number" step="0.1" min="0" placeholder="Ej. 4.5" />
        </div>
        <div class="field">
          <label for="ancho">Ancho (m)</label>
          <input id="ancho" type="number" step="0.1" min="0" placeholder="Ej. 3.5" />
        </div>
      </div>

      <div class="field">
        <label for="alto">Altura (m)</label>
        <input id="alto" type="number" step="0.1" min="0" placeholder="Ej. 2.6 (estándar)" />
        <small>Si no sabes, usa 2.6 m para residencias.</small>
      </div>

      <!-- Tipo de ambiente -->
      <div class="field">
        <label>Tipo de ambiente</label>
        <div class="pill-row" id="ambientePills">
          <div class="pill active" data-value="dormitorio">Dormitorio</div>
          <div class="pill" data-value="sala">Sala / Oficina</div>
          <div class="pill" data-value="cocina">Cocina / Área caliente</div>
        </div>
      </div>

      <!-- Nivel de sol -->
      <div class="field">
        <label>Nivel de exposición al sol</label>
        <div class="pill-row" id="solPills">
          <div class="pill active" data-value="bajo">Bajo (sombra, poco sol)</div>
          <div class="pill" data-value="medio">Medio</div>
          <div class="pill" data-value="alto">Alto (mucho sol directo)</div>
        </div>
      </div>

      <!-- Ocupación y ventanas -->
      <div class="grid-2">
        <div class="field">
          <label for="personas">Personas habituales</label>
          <input id="personas" type="number" min="1" step="1" value="2" />
        </div>
        <div class="field">
          <label for="ventanas">Ventanas grandes</label>
          <input id="ventanas" type="number" min="0" step="1" value="1" />
        </div>
      </div>

      <button type="button" class="btn-primary" id="btnCalcular">
        Calcular carga térmica
      </button>

      <div id="error" class="error-msg" role="alert"></div>

      <!-- Resultados -->
      <section class="results" id="results" aria-live="polite" style="display: none;">
        <div class="results-header">
          <div class="results-title">Resultado estimado</div>
          <div class="results-badge" id="resultBadge">Caribe • Residencial</div>
        </div>

        <div class="btu-main">
          <div class="btu-value" id="btuValue">0</div>
          <div class="btu-unit">BTU/h</div>
        </div>
        <div class="tons-line" id="tonsLine">≈ 0.00 TR</div>

        <div class="recommended">
          <div id="recommendedText">
            Equipo sugerido: <span>—</span>
          </div>
          <div class="badges-row">
            <div class="mini-badge" id="areaBadge"></div>
            <div class="mini-badge" id="ambienteBadge"></div>
            <div class="mini-badge" id="solBadge"></div>
            <div class="mini-badge" id="extraBadge"></div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      Estimación orientativa. Para proyectos críticos usa cálculo detallado de
      ingeniería.
    </footer>
  </div>

  <script>
    // ============= UTILIDADES =============
    function seleccionarPills(containerId, callback) {
      const container = document.getElementById(containerId);
      const pills = container.querySelectorAll(".pill");
      pills.forEach((pill) => {
        pill.addEventListener("click", () => {
          pills.forEach((p) => p.classList.remove("active"));
          pill.classList.add("active");
          if (callback) callback(pill.dataset.value, pill);
        });
      });
    }

    function getPillValue(containerId) {
      const container = document.getElementById(containerId);
      const active = container.querySelector(".pill.active");
      return active ? active.dataset.value : null;
    }

    function redondearBTU(btu) {
      // Redondear a múltiplos de 100 BTU
      return Math.round(btu / 100) * 100;
    }

    function sugerirEquipo(btu) {
      const opciones = [9000, 12000, 18000, 24000, 30000, 36000, 48000];
      let sugerida = opciones[opciones.length - 1];

      for (const cap of opciones) {
        if (btu <= cap) {
          sugerida = cap;
          break;
        }
      }
      return sugerida;
    }

    // ============= MAIN =============
    seleccionarPills("ambientePills");
    seleccionarPills("solPills");

    const btn = document.getElementById("btnCalcular");
    const errorBox = document.getElementById("error");
    const resultsSection = document.getElementById("results");

    btn.addEventListener("click", () => {
      errorBox.textContent = "";
      resultsSection.style.display = "none";

      const largo = parseFloat(document.getElementById("largo").value);
      const ancho = parseFloat(document.getElementById("ancho").value);
      let   alto  = parseFloat(document.getElementById("alto").value);
      const personas = parseInt(document.getElementById("personas").value, 10);
      const ventanas = parseInt(document.getElementById("ventanas").value, 10);

      if (isNaN(largo) || largo <= 0 || isNaN(ancho) || ancho <= 0) {
        errorBox.textContent = "Ingresa al menos largo y ancho del área en metros.";
        return;
      }

      if (isNaN(alto) || alto <= 0) {
        alto = 2.6; // altura estándar
      }

      const ambiente = getPillValue("ambientePills") || "dormitorio";
      const sol = getPillValue("solPills") || "medio";

      // Área y volumen
      const area = largo * ancho;

      // Factor base para clima Caribe (BTU/m²)
      let factorBase = 650;

      // Ajuste por altura (referencia 2.6 m)
      const factorAltura = alto / 2.6;

      // Factor por tipo de ambiente
      let factorAmbiente = 1.0;
      if (ambiente === "sala") factorAmbiente = 1.1;
      if (ambiente === "cocina") factorAmbiente = 1.3;

      // Factor por nivel de sol
      let factorSol = 1.0;
      if (sol === "bajo") factorSol = 0.9;
      if (sol === "medio") factorSol = 1.0;
      if (sol === "alto") factorSol = 1.15;

      // Cálculo base
      let btuBase = area * factorBase * factorAltura * factorAmbiente * factorSol;

      // Ocupación
      let extraOcupacion = 0;
      if (!isNaN(personas) && personas > 2) {
        extraOcupacion = (personas - 2) * 600;
      }

      // Ventanas grandes
      let extraVentanas = 0;
      if (!isNaN(ventanas) && ventanas > 0) {
        extraVentanas = ventanas * 1000;
      }

      let btuTotal = btuBase + extraOcupacion + extraVentanas;
      if (btuTotal <= 0 || !isFinite(btuTotal)) {
        errorBox.textContent = "Verifica que los datos numéricos sean válidos.";
        return;
      }

      btuTotal = redondearBTU(btuTotal);
      const toneladas = btuTotal / 12000;
      const sugerido = sugerirEquipo(btuTotal);

      // Mostrar resultados
      document.getElementById("btuValue").textContent = btuTotal.toLocaleString("es-PR");
      document.getElementById("tonsLine").textContent =
        "≈ " + toneladas.toFixed(2) + " TR (toneladas de refrigeración)";

      const recommendedText = document.getElementById("recommendedText");
      recommendedText.innerHTML =
        'Equipo sugerido: <span>' +
        sugerido.toLocaleString("es-PR") +
        " BTU</span> (próximo tamaño comercial)";

      // Badges
      document.getElementById("areaBadge").textContent =
        "Área aprox: " + area.toFixed(1) + " m²";

      let ambienteLabel = "Dormitorio";
      if (ambiente === "sala") ambienteLabel = "Sala / Oficina";
      if (ambiente === "cocina") ambienteLabel = "Cocina / Área caliente";

      document.getElementById("ambienteBadge").textContent =
        "Ambiente: " + ambienteLabel;

      let solLabel = "Sol medio";
      if (sol === "bajo") solLabel = "Poco sol";
      if (sol === "alto") solLabel = "Sol alto";

      document.getElementById("solBadge").textContent = "Sol: " + solLabel;

      const extras = [];
      if (!isNaN(personas)) extras.push(personas + " pers.");
      if (!isNaN(ventanas)) extras.push(ventanas + " vent. grandes");

      document.getElementById("extraBadge").textContent =
        extras.length ? "Extras: " + extras.join(" · ") : "Extras: —";

      resultsSection.style.display = "block";
    });
  </script>
</body>
</html>
